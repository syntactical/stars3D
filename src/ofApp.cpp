#include "ofApp.h"

//--------------------------------------------------------------
void ofApp::setup(){
    ofSetLogLevel(OF_LOG_VERBOSE);
    
    ofBackground(ofColor::black);
    ofNoFill();
    
    ofSetFrameRate(60);
    
    fileName = "testMovie";
    fileExt = ".mov";
    
    vidRecorder.setVideoCodec("mpeg4");
    vidRecorder.setVideoBitrate("800k");
    
    bRecording = false;
    
    recordPixels.allocate(ofGetWindowWidth(), ofGetWindowHeight(), OF_PIXELS_RGBA);
    
    stars.resize(993);
    
    float starXpoints[993] = { 1300,1300,1300,1800,2400,2500,2600,2600,2600,2600,3000,3200,3200,3300,3300,3400,3500,3500,3500,3500,3500,3600,3600,3600,3600,3600,3600,3800,3900,3900,4000,4000,4100,4100,4300,4300,4300,4300,4300,4400,4400,4400,4500,4500,4500,4500,4500,4500,4500,4600,4600,4700,4700,4700,4700,4800,4800,4900,4900,4900,4900,4900,5000,5000,5000,5000,5000,5100,5100,5100,5200,5200,5200,5400,5400,5400,5500,5500,5500,5500,5600,5700,5700,5700,5700,5700,5800,5800,5800,5800,5800,5900,5900,5900,5900,5900,5900,6000,6000,6000,6000,6000,6000,6100,6100,6100,6100,6100,6100,6100,6200,6200,6200,6200,6200,6200,6200,6200,6200,6300,6300,6300,6300,6400,6400,6400,6500,6500,6500,6500,6600,6600,6700,6700,6700,6800,6800,6800,6900,6900,7000,7000,7000,7000,7200,7200,7200,7200,7200,7300,7300,7400,7400,7500,7500,7500,7500,7500,7500,7500,7600,7600,7600,7600,7600,7600,7600,7700,7700,7700,7800,7800,7800,7800,7800,7800,7900,8000,8000,8000,8000,8000,8000,8000,8000,8100,8100,8100,8100,8100,8100,8100,8100,8100,8100,8100,8100,8100,8200,8200,8200,8200,8200,8200,8200,8200,8200,8300,8300,8400,8400,8400,8400,8400,8400,8500,8500,8500,8500,8500,8500,8500,8500,8500,8600,8600,8600,8600,8600,8600,8600,8700,8700,8700,8700,8700,8700,8800,8800,8800,8800,8800,8800,8800,8800,8800,8800,8800,8900,8900,8900,8900,8900,8900,8900,8900,9000,9000,9000,9000,9000,9000,9000,9000,9100,9100,9100,9200,9200,9200,9200,9200,9200,9200,9200,9200,9300,9300,9300,9300,9300,9400,9400,9400,9500,9500,9500,9500,9500,9500,9500,9500,9500,9600,9600,9600,9600,9600,9700,9700,9700,9800,9800,9800,9800,9800,9800,9800,9800,9800,9900,9900,9900,9900,9900,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10100,10100,10100,10100,10100,10100,10100,10100,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10200,10300,10300,10300,10300,10300,10300,10400,10400,10400,10400,10400,10400,10400,10400,10400,10400,10400,10400,10400,10500,10500,10500,10500,10500,10500,10500,10500,10500,10500,10600,10600,10700,10700,10700,10700,10700,10700,10700,10700,10700,10800,10800,10800,10800,10800,10800,10800,10800,10800,10800,10800,10800,10800,10800,10900,10900,10900,10900,10900,10900,10900,10900,11000,11000,11000,11000,11000,11000,11000,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11200,11200,11200,11200,11200,11200,11200,11200,11200,11200,11200,11200,11200,11200,11200,11300,11300,11300,11300,11300,11300,11400,11400,11400,11400,11400,11400,11400,11400,11400,11400,11400,11400,11400,11500,11500,11500,11500,11500,11500,11500,11500,11500,11500,11500,11500,11500,11500,11600,11600,11600,11600,11600,11600,11600,11600,11600,11700,11700,11700,11700,11700,11800,11800,11800,11800,11800,11800,11800,11800,11800,11800,11800,11800,11800,11800,11800,11900,11900,11900,11900,11900,11900,11900,11900,11900,11900,12000,12000,12000,12000,12000,12000,12000,12000,12000,12000,12000,12000,12000,12000,12100,12100,12100,12100,12100,12100,12100,12200,12200,12200,12200,12200,12200,12200,12200,12200,12200,12300,12300,12300,12300,12300,12300,12300,12300,12300,12300,12300,12300,12300,12300,12300,12400,12400,12400,12400,12400,12500,12500,12500,12500,12500,12500,12500,12500,12500,12500,12500,12500,12500,12500,12500,12600,12600,12600,12600,12600,12600,12600,12600,12600,12600,12600,12700,12700,12700,12700,12700,12700,12700,12700,12700,12700,12700,12700,12700,12700,12700,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12800,12900,12900,12900,12900,12900,12900,12900,12900,12900,12900,12900,12900,12900,12900,13000,13000,13000,13000,13000,13000,13000,13000,13000,13000,13000,13000,13000,13100,13100,13100,13100,13100,13100,13100,13100,13100,13100,13100,13100,13100,13100,13200,13200,13200,13200,13200,13200,13200,13200,13200,13200,13200,13200,13200,13300,13300,13300,13300,13300,13300,13300,13300,13300,13300,13300,13300,13300,13300,13400,13400,13400,13400,13400,13400,13400,13400,13400,13400,13400,13400,13500,13500,13500,13500,13500,13500,13500,13500,13500,13500,13500,13500,13600,13600,13600,13600,13600,13600,13600,13600,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13700,13800,13800,13800,13800,13800,13800,13800,13800,13800,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,13900,14000,14000,14000,14000,14000,14000,14000,14000,14000,14000,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14100,14200,14200,14200,14200,14200,14200,14200,14200,14200,14200,14200,14200,14200,14200,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14300,14400,14400,14400,14400,14400,14400,14400,14400,14400,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14500,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14600,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14700,14800,14800,14800,14800,14800,14800,14800,14800,14800,14800,14800,14800,14800,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,14900,15000,15000,15000,15000,15000,15000,15000,15000,15000,15000,15000,15000,15000,15100,15100,15100,15100,15100,15100,15100,15100,15100,15100,15100,15100,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15200,15300,15300,15300,15300,15300,15300,15300,15300,15300 };
    
    float starYpoints[993] = { 900,1000,1000,1500,-600,-1100,-1800,-1800,-600,-600,2900,-2100,-1000,0,1300,1300,-2800,-2800,0,500,500,-2900,-1500,-1500,-1000,0,2200,-3200,-1100,2800,-1000,-1000,-3400,-3400,-800,400,400,3300,3900,1000,-1300,-2500,3500,4300,-600,-2600,-2900,1400,-500,2000,1200,-100,900,900,1500,-2100,-2100,-2900,-2300,3300,4100,2900,-3700,-3700,-3700,4900,-900,4300,4300,3400,100,-3700,-3700,-2500,1600,-4800,-4600,-4600,-5300,3900,-1500,-4800,5300,5300,5300,5200,-5600,-3600,-5600,5100,-1000,-4700,-2800,4600,5200,4500,4500,-3200,-3200,5900,5900,5900,-200,-1000,-1100,4100,4500,5200,5200,-4900,1800,-4400,5200,-700,-700,-5100,5000,6200,6200,-4500,4800,1600,1600,700,-6000,1900,200,-5400,5900,-2200,-2300,600,3000,3000,2200,-5200,3700,2600,1200,300,6900,6900,6900,-1000,400,-4700,-4700,-2100,3300,2100,-700,4200,4200,7300,700,3300,-2100,5800,-4200,3300,-5800,2200,-4300,-4300,3100,-3800,-6500,3700,6600,3100,-7300,-2500,7000,2800,2200,-6300,800,-7300,-7200,-2100,-2100,1500,-1300,4500,4500,2900,2000,-2300,-1400,-4500,1900,2600,1400,1400,5500,-1700,2800,2800,-7100,-2900,-200,1200,3100,7100,3500,3500,7800,-8200,-4100,3200,-1500,4600,4600,4600,2100,-6200,900,-5300,-5300,4100,8000,8000,-3700,-5400,3300,-2200,5100,3500,3500,4400,-4800,-3200,-8200,-8600,-6900,-6900,1800,-6600,-6600,-6800,-7100,8300,8300,7400,5000,3500,-1800,2200,-5200,-5200,-2400,2600,5300,-5100,1900,5500,-6000,-5600,-5600,-2300,2100,-5100,1000,1200,-4400,800,7500,-6400,-6700,2900,2900,-2500,-2500,500,6000,-8100,-600,-8900,-6200,-6300,-8600,-5600,-3100,-9000,-6800,-300,2200,2200,-2700,2900,-1800,-7200,1500,2500,8500,8900,-8500,-9000,-4700,4900,-1200,-4400,4700,-7200,-9400,400,4700,8400,4300,9200,-100,7800,1500,-1900,9200,-1300,8200,-6300,-4000,-6500,-9700,-7400,3100,6000,6000,6000,-5200,-5200,2400,-5700,5700,8000,-3100,-2000,-2700,5800,2000,2000,-9100,-2300,2700,-3500,5200,4000,4000,8100,8100,4100,4100,-6700,-5700,1500,4700,-10300,-9300,-7300,5800,3800,-7800,-7700,-5100,4900,-5300,-9900,-3600,-3600,-500,-1300,-1300,-5700,-7400,7400,-800,-8500,1700,-3800,-3800,-6400,2900,-6300,-9200,2200,-2700,-8800,6700,800,-1400,-1400,9000,4900,4900,-600,3000,-5500,-10200,-10200,-6100,2700,5000,5000,9700,9500,9500,-5100,-5100,-7800,-5300,8000,-2000,0,600,500,-5900,3900,4300,-4800,-9700,-3700,200,-3000,6800,-100,5700,-8100,-4100,-2000,-1200,7400,6900,-7000,10000,4200,8600,-2700,-6700,-10700,2400,9600,-500,-900,-8600,-8600,-7400,-7400,300,2100,2100,-100,-100,9600,9600,9300,8000,-7400,-7400,3300,3900,-5200,5300,-10800,-10500,-6300,2000,2000,5300,-2400,6500,4200,4200,4300,5600,-6600,-600,-1000,1700,-10900,-4600,-10500,-9000,-4400,-7000,5100,-1500,-7000,4700,-1600,-2600,-10200,-10200,7100,8800,8700,-2800,-6900,2800,3800,-600,-7100,-3900,1400,-500,-4700,-4700,2700,2700,8200,6300,8100,9900,6500,1400,-9200,-10300,8100,9900,-8900,1900,-3700,-4300,-4300,7300,-8700,11100,10300,6700,-1400,2600,2600,4800,6100,6800,6800,-8000,-5100,-7500,-7500,3000,3000,4500,-7900,1300,1300,-10900,8900,9300,7900,5300,-2900,-11100,-3700,-7300,-10200,-4200,-4100,-4600,6600,-11600,-4000,10800,9600,-4500,4000,-3700,-6500,-11200,-12000,-7800,7700,5400,2900,3900,-8200,-2400,-3400,-3400,-12000,-1100,-7100,-11400,-9500,-9500,-2600,4100,1300,6500,-4700,-10400,-5100,-8700,-4300,4400,-6200,-9500,-6500,-12400,-5300,-7100,-8100,11000,11000,3100,11400,9600,8400,12000,-12500,-9700,-6800,8800,8800,-3500,3600,-11700,-10200,6800,4200,7200,10200,10700,-10600,-10000,-12000,1200,1200,12100,-1400,2400,900,3300,-100,-800,2900,-200,-12400,10600,-12300,-12300,-7200,-700,-700,5000,5000,1900,12100,2400,2400,11900,3900,-10900,4500,3500,12500,12600,-8100,-3700,-9900,-12600,-5100,9300,-1300,100,-1200,-12500,-12500,-200,11000,-3800,9100,2400,-4800,-1100,-11000,-9000,2900,-500,-12700,2500,1100,1100,100,12800,-6300,-11400,-7200,-5600,4800,7500,-4000,-11600,-8900,-9300,-9300,-800,12700,12700,2900,-12700,-8000,10600,-1700,5500,-1400,7700,-1700,1300,-400,-8400,-2400,5100,5100,9900,9900,8600,-10500,-10500,-12900,-9100,-9100,-9100,-3400,-8400,8400,6100,4900,3500,2800,2800,1200,7900,7900,-11800,11600,3400,-7100,-8200,-10200,-11400,-500,-4200,-3100,-4200,-4200,2500,2500,11600,11600,9300,9300,4900,-12800,-8700,-12800,-1500,-12800,3300,3300,8600,300,-6400,-400,1800,6800,-3200,-9700,-7700,9000,11800,12700,8600,2600,-1200,-13000,-2700,1900,7400,11800,6900,3300,3700,700,-2000,-13600,-10100,-6000,-12700,-1100,12200,3700,600,200,-5100,-5200,-5200,-12400,-6800,-6800,-6300,400,-200,-200,-200,12300,-4600,-6000,-3900,-1400,10000,4600,6400,6400,-7800,-11400,-10500,-10500,5600,5600,8500,7900,7900,12400,-1200,-8700,300,-400,10200,-13300,-14000,-10100,1100,2200,2200,6000,10700,-1900,-10000,-3000,-9900,-11000,-11300,-2800,6900,10400,11700,10400,-10700,-9400,3500,4400,4400,12100,6800,5500,-13400,13800,6500,3000,9200,-6900,6600,700,700,11700,12500,10700,-5300,-5300,-900,10700,9500,7000,9600,8600,-13000,-7800,-6800,-6800,-11000,-11000,-11000,-500,-500,12100,12600,12600,11300,6700,6700,-8200,1500,14100,-11500,-14300,-14200,-7300,10800,10800,13200,11200,9900,-11200,-12000,-4100,4800,6200,11200,4300,3300,-10200,-11900,-2900,-2900,4200,6700,9800,7400,8100,8500,-4100,5700,3000,-14000,1500,11800,-11700,-3200,-8700,-9200,-6700,-9500,-9500,-12500,-10300,6400,9200,7000,-3900,-4100,2400,1500,1200,13700,-6100,-1300,-6300,-11000,-7500,-7500,-7500,-8600,6500,6500,-2800,-11000,4100,7500,-10100,-2700,-4000,-3700,1700,-1200,10300,3200,2000,2000,9500,-3500,-14600,-9700,-5400,-5400,-600,-600,13700,13700,-8500,-12600,-10500,-10000,-3900,8000,7400,900,-4200,-13000,11500,-11500,-4100,-5100,-5100,14100,-5900};
    
    float starZpoints [993] = {-900,-900,-900,900,-1200,-100,-1900,-1900,100,100,600,-600,2800,-1700,100,1400,-1900,-1900,3200,3400,3500,-900,3000,3000,100,3300,-1000,-2000,-3000,200,3900,3900,-2200,-2200,-2500,-1300,-1300,-1600,200,-300,2000,-900,-1700,-1300,3800,1600,-2400,-4300,-3400,-4100,1700,1800,4600,4600,1900,400,400,700,-1700,-600,-2600,3200,-1400,-1400,-1400,-1200,4800,2500,2500,3800,1200,-1900,-1900,3400,-200,-2200,2900,2900,-300,2300,-2900,-2400,1000,1000,1000,-700,-1400,-4100,-300,-2400,5200,-3400,-5100,-1800,-2700,3800,3800,5000,5000,-200,-200,-200,3300,5200,-3200,-1600,-2600,500,500,-2400,-5800,1200,-500,4800,4800,-3200,-2400,-300,-300,1200,-500,4800,4800,-400,100,-6100,-2000,-3100,1200,6100,-1700,4800,1300,1300,5800,-3500,-2900,600,-6400,5400,-1000,-1000,-1000,6800,3700,1400,1400,-4500,-5700,5500,6400,5800,5800,1800,400,-4700,3400,-2300,3700,2800,3000,-1100,6100,6100,900,-1400,3200,-6200,3000,1100,-2200,-5400,3200,6800,-1200,3100,1000,-2900,-1500,-7400,-7400,5600,7600,4200,4200,-7100,4100,7000,-5600,6700,-2300,-4600,-3900,-3900,5000,6900,2100,7100,200,1800,7300,-2100,-1800,-1400,7200,7200,0,-1300,-4600,-7700,1500,6000,6000,6000,-7100,500,-3900,-4800,-4800,-4600,-2500,-2500,4400,2800,-4200,100,6900,2700,2700,-4900,-6100,-3000,-2100,-1300,-5300,-5300,2200,-5500,-5500,-3200,-3300,-2700,-2700,2100,6700,5100,-2500,-7500,-7200,-7200,-8500,-5800,7100,2900,-5800,-4000,-2000,-6000,-6000,-8000,-7700,7400,8300,2600,4100,1800,-4800,-5700,200,-8100,-8100,500,500,500,-3700,2300,9100,0,-5000,-4800,2600,6400,-400,0,-1800,-9400,-8200,-8200,-200,7700,-2000,-3400,7400,-1100,2300,-3500,1000,600,-6400,-8100,5700,-600,8200,4100,-2700,-9800,1600,2000,6200,-3000,900,1700,-1900,6400,2400,1000,4500,7700,1500,7600,1400,3100,6600,5400,700,-7300,8600,8600,-8600,8300,4000,6200,3100,5600,-8800,8300,-7000,-7000,4600,-1400,-8000,5400,-2400,2600,2600,1600,1600,5300,5300,4500,-3500,-10000,-6100,-500,-2000,2100,6100,6900,6700,900,-300,4000,-1100,3200,-1000,-1000,-3900,3600,3600,2300,5800,7200,-8200,6100,-10300,-8600,-8600,3800,-9400,8100,-700,3200,7600,4100,8300,-9000,8100,8200,4800,9600,9600,8100,8200,2700,-3500,-3500,9000,-4300,6500,6500,2700,3300,3300,9200,9200,6000,-2000,7400,-6200,-5300,2400,-5100,-9100,5800,4800,9600,-4700,1300,8600,9600,-3000,-6700,-3900,-4200,7300,-10900,-3400,-3100,3600,8500,2800,9200,7000,-900,3600,1300,-10900,-3800,6700,-8700,6900,6900,-1100,-1100,-11000,-1000,-1000,4500,4500,5400,5400,2900,7600,5500,5500,300,1000,3400,9600,-2700,-500,-5400,-2200,9700,-6300,-2800,-5300,9600,9600,10500,3400,-8400,-9200,-5000,-7400,900,10000,-500,4500,-10400,5500,2200,-11400,6000,7200,-10600,7200,1800,1800,-3700,7600,7100,6000,-9400,4600,10800,-9300,5600,-3100,6000,-100,10200,10300,-5000,-5000,-8500,3000,2300,-1900,5000,10600,7100,-1800,-8400,-1900,1600,11600,-4800,-1400,-1400,-3800,7700,-200,-3000,-1600,-8300,1000,1000,9700,-10400,7800,7800,9000,8000,-6900,-6900,-6800,-6800,8700,8700,-8100,-8100,-2400,-7600,-2400,5800,8000,10200,4400,-11600,-4000,4000,-11100,-10900,-800,-5500,-2200,-8300,-4900,-7500,2400,9400,6300,-5600,-600,-900,4000,-8300,10900,11300,-200,-6200,-3200,9600,9600,-2400,-8800,8400,4500,-2900,-2900,-9400,-11300,12400,4500,9800,200,-11400,5800,-10900,-11700,8300,-8000,-3700,2700,9200,-10000,8800,-3900,-3900,11100,-4900,6200,9000,4100,-800,-8100,-7400,5900,5900,-2400,-7500,-400,-6200,-7600,11100,-8200,5300,-6300,-6100,-4700,-3200,6800,6800,-4000,10600,9400,-9200,-8900,11400,10100,-100,-11100,3500,5200,3900,3900,3500,-10600,-10600,-11900,-11900,-8000,-4000,3900,3900,-200,-10400,-5400,-12200,-100,-2200,2800,10200,-1100,500,1500,6700,6100,8200,-7300,-9300,3900,3900,-300,-1500,9700,8900,12300,12200,-11900,3400,5900,1200,-800,300,1700,-10400,-10400,2300,3200,11200,5300,6400,7000,-600,9900,-11400,6500,-6300,-7000,-7000,4700,-500,-500,-200,-500,2400,-1900,10500,8400,4600,-3200,-8100,-4100,7100,10500,11900,12300,12300,-5600,-5600,-100,8500,8500,400,-1200,2400,2400,-3300,9400,7700,2200,-5000,-9400,7800,7800,-4300,-3000,-3000,5500,5300,11500,10600,10000,-900,6400,-13700,-10900,-10700,-7600,10700,1800,1800,-7400,-6700,9700,9700,12300,-2200,7100,3800,13300,3800,-700,-700,8000,8500,11600,8300,400,-1400,10500,6100,3700,-10400,400,-2600,4100,4200,2600,4800,-7700,7400,10900,7200,10900,9900,10400,-12600,-4600,300,5000,-2300,5800,6000,1000,7100,7600,-9000,11200,-5100,-5100,-4600,-200,-200,500,-700,11900,11900,11900,6900,13300,9300,-13500,8200,8800,12600,2400,2400,-4700,6700,-9300,-9300,-4500,-4500,-7100,4200,4200,3800,12900,-3500,-10200,-5800,-3700,900,-1800,5700,-2800,-1400,-1400,1200,7800,13900,9800,-3500,0,-400,-7600,2500,-300,-9200,-6100,-500,-9300,3600,3500,8500,8500,-7600,10100,13100,300,-3800,-12300,-300,-8700,-11200,-4600,10900,10900,8200,-5300,9600,4500,4500,-12200,-4300,500,3500,8200,9900,3500,-12100,-11900,-11900,1600,1600,1600,7300,7300,-7800,2200,2200,4400,10000,10000,-10600,-13800,-3500,-8700,-1800,-3400,8100,1800,1800,-6000,4100,-2400,-1800,-4000,-4400,-4200,-2900,-2000,11900,3700,600,-8400,-14000,-14000,-11000,-5900,7600,11200,-6300,-11400,13400,13500,-4200,-1200,13400,6700,-8700,-13500,-2300,1800,6300,11500,11500,5300,-3600,1400,10100,13100,14400,13500,4500,-8700,-12500,-1100,12500,-10400,-11700,-9100,-11500,-11500,-11500,12400,13000,13000,14500,4200,10300,-7100,-1600,-13700,-13900,5100,-4600,12100,11100,14700,14900,14900,-1500,-5200,3900,-10200,-14200,-14100,900,900,-5800,-5800,12300,7900,-1900,-3200,5900,7800,8800,5800,10500,7300,5400,7400,-1400,5100,5100,-5100,5900};
    
    for (vector<ofPoint>::size_type i = 0; i < stars.size(); i++) {
        stars[i] = ofPoint(ofRandom(-ofGetWindowWidth()/4,ofGetWindowWidth()/4), ofRandom(-ofGetWindowWidth()/4,ofGetWindowHeight()/4), ofRandom(-200,200));
    }
}

//--------------------------------------------------------------
void ofApp::update(){
    if(bRecording){
        cout << recordPixels.size();
        recordTexture.readToPixels(recordPixels);
        
        cout << recordPixels.size();
        bool success = vidRecorder.addFrame(recordPixels);
        if (!success) {
            ofLogWarning("This frame was not added!");
        }
    }
    
    // Check if the video recorder encountered any error while writing video frame or audio smaples.
    if (vidRecorder.hasVideoError()) {
        ofLogWarning("The video recorder failed to write some frames!");
    }
    
    if (vidRecorder.hasAudioError()) {
        ofLogWarning("The video recorder failed to write some audio samples!");
    }
}

void ofApp::exit() {
    vidRecorder.close();
}

//--------------------------------------------------------------
void ofApp::draw(){
    ofEnableDepthTest();
    
    float time = ofGetElapsedTimef();
    float angle = time * 10;

    ofVec3f center=ofVec3f(0,0,0);
    cam.orbit(-angle,-angle/10-20,400-angle,center);
    
    cam.begin();
    
    ofSetColor(ofColor::white);
    
    ofPushMatrix();
    
    //ofTranslate(ofGetWindowWidth() / 2, ofGetWindowHeight() / 2);
    //ofRotateY(angle);
    
    ofSetColor(ofColor::gray);
    //drawAxes();
    
    //ofDrawAxis(400);
    
    ofDrawGrid(500.0f, 25.0f, true);
    
    ofSetColor(ofColor::white);
    
    for (vector<ofPoint>::size_type i = 0; i < stars.size() - 1; i++) {
        drawStar(stars[i]);
    }
    
    ofPopMatrix();
    
    cam.end();
}

void ofApp::drawAxes(){
    ofLine(-1000, 0, 0, 1000, 0, 0);
    ofLine(0, -1000, 0, 0, 1000, 0);
    ofLine(0, 0, -1000, 0, 0, 1000);
}

void ofApp::drawStar(ofPoint point) {
    float diameter = 2;
    float radius = diameter / 2;
    
    ofPushMatrix();
    
    ofTranslate(point.x, point.y, point.z);
    
    ofLine(-diameter, 0, 0, diameter, 0, 0);
    ofLine(0, -diameter, 0, 0, diameter, 0);
    ofLine(0, 0, -diameter, 0, 0, diameter);
    
    ofCircle(0, 0, 0, radius);
    
    ofPushMatrix();
    
    ofRotateY(90);
    
    //ofCircle(0, 0, 0, radius);
    
    ofPopMatrix();
    
    ofPushMatrix();
    
    ofRotateZ(90);
    
    //ofCircle(0, 0, 0, radius);
    
    ofPopMatrix();
    ofPopMatrix();
}

//--------------------------------------------------------------
void ofApp::keyPressed(int key){

}

//--------------------------------------------------------------
void ofApp::keyReleased(int key){
    if(key=='r'){
        bRecording = !bRecording;
        if(bRecording && !vidRecorder.isInitialized()) {
            vidRecorder.setup(fileName+ofGetTimestampString()+fileExt, ofGetWindowWidth(), ofGetWindowHeight(), 30);
            //          vidRecorder.setup(fileName+ofGetTimestampString()+fileExt, vidGrabber.getWidth(), vidGrabber.getHeight(), 30); // no audio
            //            vidRecorder.setup(fileName+ofGetTimestampString()+fileExt, 0,0,0, sampleRate, channels); // no video
            //          vidRecorder.setupCustomOutput(vidGrabber.getWidth(), vidGrabber.getHeight(), 30, sampleRate, channels, "-vcodec mpeg4 -b 1600k -acodec mp2 -ab 128k -f mpegts udp://localhost:1234"); // for custom ffmpeg output string (streaming, etc)
            
            // Start recording
            vidRecorder.start();
        }
        else if(!bRecording && vidRecorder.isInitialized()) {
            vidRecorder.setPaused(true);
        }
        else if(bRecording && vidRecorder.isInitialized()) {
            vidRecorder.setPaused(false);
        }
    }
    if(key=='c'){
        bRecording = false;
        vidRecorder.close();
    }
}

void ofApp::initializeStarPoints(){
    
}

//--------------------------------------------------------------
void ofApp::mouseMoved(int x, int y ){

}

//--------------------------------------------------------------
void ofApp::mouseDragged(int x, int y, int button){

}

//--------------------------------------------------------------
void ofApp::mousePressed(int x, int y, int button){

}

//--------------------------------------------------------------
void ofApp::mouseReleased(int x, int y, int button){

}

//--------------------------------------------------------------
void ofApp::windowResized(int w, int h){

}

//--------------------------------------------------------------
void ofApp::gotMessage(ofMessage msg){

}

//--------------------------------------------------------------
void ofApp::dragEvent(ofDragInfo dragInfo){ 

}
